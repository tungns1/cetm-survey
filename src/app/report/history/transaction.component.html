<div class="modal-header">
    <span i18n>Ticket Detail</span>
</div>

<!-- Ticket -->
<div id="modal-history">
    <accordion [expand]="true">
        <accordion-title class="accordionTitle">
            <span i18n>Ticket Detail</span>
        </accordion-title>
        <table class="detailTicket">
            <tr>
                <td><b i18n>Branch</b></td>
                <td>{{data.parent}}</td>
            </tr>
            <tr>
                <td><b i18n>Store</b></td>
                <td>{{data.branch}}</td>
            </tr>
            <tr>
                <td><b i18n>Counter Number</b></td>
                <td>{{data.counter}}</td>
            </tr>
            <tr>
                <td><b i18n>Teller</b></td>
                <td>{{data.user}}</td>
            </tr>
            <tr *ngIf="manager; let u">
                <td><b i18n>Manager</b></td>
                <td>{{u.fullname}}</td>
            </tr>
            <tr *ngIf="admin; let u">
                <td><b i18n>Administrator</b></td>
                <td>{{u.fullname}}</td>
            </tr>
            <tr>
                <td><b i18n>Ticket Number</b></td>
                <td>{{data.cnum}}</td>
            </tr>
            <tr>
                <td> <b i18n>Service Name</b></td>
                <td>{{data.service}}</td>
            </tr>
            <tr>
                <td><b i18n>Ticket Status</b></td>
                <td><span class="uppercase">{{data | ticketState}}</span></td>
            </tr>
            <tr>
                <td><b i18n>Print Time</b></td>
                <td>{{ctime}}</td>
            </tr>
            <tr>
                <td><b i18n>Waiting Duration</b></td>
                <td>{{data.wtime}}</td>
            </tr>
            <tr>
                <td><b i18n>Serving Duration</b></td>
                <td>{{data.stime}}</td>
            </tr>
            <tr>
                <td><b i18n>Date</b></td>
                <td>{{data.cdate}}</td>
            </tr>
            <tr>
                <td><b i18n>Rating</b></td>
                <td>{{data.rating}}</td>
            </tr>
            <tr *ngIf="data.reason_text">
                <td><b i18n>Reason Text</b></td>
                <td>{{data.reason_text}}</td>
            </tr>
            <tr *ngIf="!data.reason_text">
                <td><b i18n>Reason Text</b></td>
                <td>_</td>
            </tr>
        </table>
    </accordion>

    <div class="cusDetail">
        <audio [class.hidden]="!audio_url" controls [src]="audio_url"></audio>
    </div>

    <!-- Customer Data -->
    <div *ngIf="customer" class="customer">
        <div *ngIf="customer.full_name" class="cusDetail" fxLayout="row">
            <b fxFlex="42%" i18n>Customer</b>
            <span fxFlex>{{customer.full_name}}</span>
        </div>
        <div *ngIf="customer.phone_number" class="cusDetail" fxLayout="row">
            <b fxFlex="42%" i18n>Phone Number</b>
            <span fxFlex>{{customer.phone_number}}</span>
        </div>
        <div *ngIf="customer.code" class="cusDetail" fxLayout="row">
            <b fxFlex="42%" i18n>Customer Code</b>
            <span fxFlex (click)="goToCustomer(data.customer_id); close()" style="text-decoration: underline; color: blue; cursor: pointer" i18n-title="Go to customer detail">{{customer.code}}</span>
        </div>
        <div *ngIf="customer.segment" class="cusDetail" fxLayout="row">
            <b fxFlex="42%" i18n>Customer Segment</b>
            <span fxFlex>{{customer.segment}}</span>
        </div>
    </div>

    <!-- survey data -->
    <div *ngIf="data.survey">
        <div class="survey"> Survey result</div>
        <div class="cusDetail" fxLayout="row">
            <b fxFlex="42%" i18n>Score Text</b>
            <span fxFlex>{{data.survey.score_text}}</span>
        </div>
        <div class="cusDetail" fxLayout="row">
            <b fxFlex="42%" i18n>Reason Text</b>
            <span fxFlex>{{data.survey.reason_text}}</span>
        </div>
    </div>
</div>

<div fxLayout="row" class="margin-20-0">
    <div fxFlex="7%"></div>
    <div fxFlex></div>
    <button fxFlex class="btnFill ctrlBtn" (click)="close()" i18n>Close</button>
    <div fxFlex="7%"></div>
</div>